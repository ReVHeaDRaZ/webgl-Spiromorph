<!doctype html>
<html>
<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image" href="./RaZLogo1.png" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Spiromorph - A morphing spirograph" />
    
  <title>Spiromorph</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" type="text/css" href="./style.css">
</head>
<body>
  <h1>SPIROMORPH</h1>
  
  <button id="toggleUI" onclick="toggleUIPanel()">☰ Controls</button>
  
  <div id="ui">
    <div class="param-section">
      <h3 onclick="toggleSection(this)">MULTI-SPIROMORPH</h3>
      <div class="param-content">
        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px;">
          <button onclick="removeSpiromorph()" style="padding: 8px 16px; font-size: 16px; cursor: pointer; background: #333; color: white; border: 1px solid #666; border-radius: 4px;">−</button>
          <div style="flex: 1; text-align: center;">
            <span style="font-weight: bold;">Count: </span>
            <span id="spiromorphCount" style="font-size: 18px; color: #00ff88;">1</span>
          </div>
          <button onclick="addSpiromorph()" style="padding: 8px 16px; font-size: 16px; cursor: pointer; background: #333; color: white; border: 1px solid #666; border-radius: 4px;">+</button>
        </div>
        
        <p style="font-size: 12px; opacity: 0.7; margin-top: 0;">
          All spiromorphs share the same parameters below
        </p>
      </div>
    </div>
    
    <div class="param-section">
      <h3 onclick="toggleSection(this)">SPIROMORPH PARAMETERS</h3>
      <div class="param-content">
        <label for="spd">Speed</label>
        <input id="spd" type="range" min="0.01" max="1" step="0.01" value="0.15" oninput="updateSpdValue()">
        <output for="spd" id="spdValue">0.15</output>
        
        <label for="amp">Amplitude</label>
        <input id="amp" type="range" min="0.1" max="2.5" step="0.01" value="0.8" oninput="updateAmpValue()">
        <output for="amp" id="ampValue">0.8</output>

        <label for="elements">No. of elements</label>
        <input id="elements" type="range" min="1" max="6" step="1" value="6" oninput="updateElementsValue()">
        <output for="elements" id="elementsValue">6</output>

        <label for="envinphase">Envelopes in phase</label>
        <input id="envinphase" type="range" min="1" max="5" step="1" value="3" oninput="updateEnvInPhaseValue()">
        <output for="envinphase" id="envInPhaseValue">3</output>
      </div>
    </div>
    
    <div class="param-section">
      <h3 onclick="toggleSection(this)">BLOOM SHADER</h3>
      <div class="param-content">
        <label for="threshold">Threshold</label>
        <input id="threshold" type="range" min="0" max="1" step="0.01" value="0.25">
        
        <label for="iters">Blur iterations</label>
        <input id="iters" type="range" min="1" max="8" step="1" value="4">
        
        <label for="intensity">Intensity</label>
        <input id="intensity" type="range" min="0" max="5" step="0.05" value="2.0">
        
        <label for="down">Downsample factor</label>
        <input id="down" type="range" min="1" max="4" step="1" value="2">
      </div>
    </div>
  </div>

  <div class="credits">Original Spiromorph effect written by Michael Clift
    <br> 
   <a href="https://github.com/mickjc750">https://github.com/mickjc750</a>
   <br>
   Rewritten for webgl with shaders, realtime parameters and multiple instances by Ryan Owens
  </div>

  <canvas id="glcanvas"></canvas>
  <script src="shaders.js"></script>
  <script src="morph.js"></script>
  <script src="main.js"></script>

  <script>
    function toggleUIPanel() {
      const ui = document.getElementById('ui');
      ui.classList.toggle('visible');
    }

    function toggleSection(header) {
      const content = header.nextElementSibling;
      const isCollapsed = content.classList.contains('collapsed');
      
      if (isCollapsed) {
        content.classList.remove('collapsed');
        header.classList.remove('collapsed');
      } else {
        content.classList.add('collapsed');
        header.classList.add('collapsed');
      }
    }

    function updateSpdValue() {
        const rangeInput = document.getElementById("spd");
        const outputElement = document.getElementById("spdValue");
        outputElement.value = rangeInput.value;
    }
    function updateAmpValue() {
        const rangeInput = document.getElementById("amp");
        const outputElement = document.getElementById("ampValue");
        outputElement.value = rangeInput.value;
    }
    function updateElementsValue() {
        const rangeInput = document.getElementById("elements");
        const outputElement = document.getElementById("elementsValue");
        outputElement.value = rangeInput.value;
    }
    function updateEnvInPhaseValue() {
        const rangeInput = document.getElementById("envinphase");
        const outputElement = document.getElementById("envInPhaseValue");
        outputElement.value = rangeInput.value;
    }
  </script>
</body>
</html>